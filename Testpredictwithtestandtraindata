#https://github.com/johndehavilland/deeplearningseries/blob/master/stock_price_predictor.ipynb
#Mount Google Drive to the Colab Env
#On left Menu-->Files-->download desired gdrive files
from google.colab import drive
drive.mount('/content/drive/')
from keras import backend as K
import os
from importlib import reload
COLUMN = 'ABT'

#'/content/drive/My Drive/IC Tech/IC Test/sp500_joined_closes_correct.csv'
import numpy as np # linear algebra
import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)
from keras.layers.core import Dense, Activation, Dropout
from keras.layers.recurrent import LSTM
from keras.models import Sequential
from sklearn.model_selection import  train_test_split
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
import matplotlib.pyplot as plt
import math
np.random.seed(7)

#load the dataset

dataset = pd.read_csv('/content/drive/My Drive/IC Tech/IC Test/sp500_joined_closes_correct.csv', delimiter = ";")

# Delete All NaN values from columns -> ['description','rate']
dataset = dataset[dataset['date'].notnull() & dataset[COLUMN].notnull()]
#dataset = dataset[dataset['date'].notnull() & dataset[COLUMN].notnull()& dataset['MMM'].notnull()]


dataset.head()
dataset.dtypes
